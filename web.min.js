var MITO=function(e){"use strict";var t=function(){return(t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function n(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function r(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var o,i,a,s,c,u,p,l,f,h=function(){return(h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};!function(e){e.UNKNOWN="UNKNOWN",e.UNKNOWN_FUNCTION="UNKNOWN_FUNCTION",e.JAVASCRIPT_ERROR="JAVASCRIPT_ERROR",e.LOG_ERROR="LOG_ERROR",e.FETCH_ERROR="HTTP_ERROR",e.VUE_ERROR="VUE_ERROR",e.REACT_ERROR="REACT_ERROR",e.RESOURCE_ERROR="RESOURCE_ERROR",e.PROMISE_ERROR="PROMISE_ERROR",e.ROUTE_ERROR="ROUTE_ERROR"}(o||(o={})),function(e){e.AppOnLaunch="AppOnLaunch",e.AppOnShow="AppOnShow",e.AppOnHide="AppOnHide",e.AppOnError="AppOnError",e.AppOnPageNotFound="AppOnPageNotFound",e.AppOnUnhandledRejection="AppOnUnhandledRejection"}(i||(i={})),function(e){e.PageOnLoad="PageOnLoad",e.PageOnShow="PageOnShow",e.PageOnHide="PageOnHide",e.PageOnReady="PageOnReady",e.PageOnUnload="PageOnUnload",e.PageOnShareAppMessage="PageOnShareAppMessage",e.PageOnShareTimeline="PageOnShareTimeline",e.PageOnTabItemTap="PageOnTabItemTap"}(a||(a={})),function(e){e.SwitchTab="switchTab",e.ReLaunch="reLaunch",e.RedirectTo="redirectTo",e.NavigateTo="navigateTo",e.NavigateBack="navigateBack",e.NavigateToMiniProgram="navigateToMiniProgram",e.RouteFail="routeFail"}(s||(s={})),h(h(h({},i),a),o),function(e){e.ROUTE="Route",e.CLICK="UI.Click",e.CONSOLE="Console",e.XHR="Xhr",e.FETCH="Fetch",e.UNHANDLEDREJECTION="Unhandledrejection",e.VUE="Vue",e.REACT="React",e.RESOURCE="Resource",e.CODE_ERROR="Code Error",e.CUSTOMER="Customer",e.APP_ON_SHOW="App On Show",e.APP_ON_LAUNCH="App On Launch",e.APP_ON_HIDE="App On Hide",e.PAGE_ON_SHOW="Page On Show",e.PAGE_ON_HIDE="Page On Hide",e.PAGE_ON_UNLOAD="Page On Unload",e.PAGE_ON_SHARE_APP_MESSAGE="Page On Share App Message",e.PAGE_ON_SHARE_TIMELINE="Page On Share Timeline",e.PAGE_ON_TAB_ITEM_TAP="Page On Tab Item Tap",e.TAP="UI.Tap",e.TOUCHMOVE="UI.Touchmove"}(c||(c={})),function(e){e.HTTP="http",e.USER="user",e.DEBUG="debug",e.EXCEPTION="exception",e.LIFECYCLE="lifecycle"}(u||(u={})),function(e){e.XHR="xhr",e.FETCH="fetch",e.CONSOLE="console",e.DOM="dom",e.HISTORY="history",e.ERROR="error",e.HASHCHANGE="hashchange",e.UNHANDLEDREJECTION="unhandledrejection",e.MITO="mito",e.VUE="Vue",e.MINI_ROUTE="miniRoute",e.MINI_PERFORMANCE="miniPerformance",e.MINI_MEMORY_WARNING="miniMemoryWarning",e.MINI_NETWORK_STATUS_CHANGE="miniNetworkStatusChange",e.MINI_BATTERY_INFO="miniBatteryInfo"}(p||(p={})),function(e){e.XHR="xhr",e.FETCH="fetch"}(l||(l={})),function(e){e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.INTERNAL_EXCEPTION=500]="INTERNAL_EXCEPTION"}(f||(f={}));var d=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/,g={isLogAddBreadcrumb:!0,crossOriginThreshold:1e3},O=function(){return(O=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function R(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var E=Object.prototype.toString;function m(e){return function(t){return E.call(t)==="[object "+e+"]"}}var y={isNumber:m("Number"),isString:m("String"),isBoolean:m("Boolean"),isNull:m("Null"),isUndefined:m("Undefined"),isSymbol:m("Symbol"),isFunction:m("Function"),isObject:m("Object"),isArray:m("Array"),isProcess:m("process"),isWindow:m("Window")};function v(e){switch(E.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return function(e,t){try{return e instanceof t}catch(e){return!1}}(e,Error)}}function b(e){return y.isString(e)&&""===e.trim()||null==e}var T=y.isProcess("undefined"!=typeof process?process:0),N=y.isObject("undefined"!=typeof wx?wx:0)&&y.isFunction("undefined"!=typeof App?App:0),I=y.isWindow("undefined"!=typeof window?window:0);var A=I?window:N?wx:T?process:void 0,S=(A.__MITO__=A.__MITO__||{},A.__MITO__);S.replaceFlag=S.replaceFlag||{};var x=S.replaceFlag;function k(e,t){x[e]||(x[e]=t)}function U(e){return!!x[e]}var _="MITO Logger",P=function(){function e(){var e=this;if(this.enabled=!1,this._console={},A.console=console||A.console,console||A.console){["log","debug","info","warn","error","assert"].forEach((function(t){t in A.console&&(e._console[t]=A.console[t])}))}}return e.prototype.disable=function(){this.enabled=!1},e.prototype.bindOptions=function(e){this.enabled=!!e},e.prototype.enable=function(){this.enabled=!0},e.prototype.getEnableStatus=function(){return this.enabled},e.prototype.log=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.enabled&&(e=this._console).log.apply(e,R([_+"[Log]:"],t))},e.prototype.warn=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.enabled&&(e=this._console).warn.apply(e,R([_+"[Warn]:"],t))},e.prototype.error=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.enabled&&(e=this._console).error.apply(e,R([_+"[Error]:"],t))},e}(),C=S.logger||(S.logger=new P);function H(){return"undefined"==typeof document||null==document.location?"":document.location.href}function D(e,t,n,r){void 0===r&&(r=!1),e.addEventListener(t,n,r)}function w(e,t,n,r){if(void 0===r&&(r=!1),void 0!==e&&(t in e||r)){var o=n(e[t]);"function"==typeof o&&(e[t]=o)}}function L(){return Date.now()}function F(e,t,n){return!!function(e,t){return typeof e===t}(e,n)||(void 0!==e&&C.error(t+"期望传入"+n+"类型，目前是"+typeof e+"类型"),!1)}function M(e,t,n){return!!function(e,t){return E.call(e)===t}(e,n)||(void 0!==e&&C.error(t+"期望传入"+n+"类型，目前是"+E.call(e)+"类型"),!1)}function j(e){g.isLogAddBreadcrumb=!1,e(),g.isLogAddBreadcrumb=!0}function W(e){return y.isString(e)?e:y.isUndefined(e)?"undefined":JSON.stringify(e)}function q(e){return Number(e.split(".")[0])}function B(e,t){return y.isString(e)?e.slice(0,t)+(e.length>t?":截取前"+t+"个字符":""):""}function X(){if(!y.isFunction(getCurrentPages))return"";var e=getCurrentPages();if(!e.length)return"App";var t,n,r,o=e.pop();return t=o.route,n=o.options,r=[],Object.keys(n).forEach((function(e){r.push(e+"="+n[e])})),t=-1!==t.indexOf("?")?t+"&"+r.join("&"):t+"?"+r.join("&")}function G(e){if(!e)return{};var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],relative:t[5]+n+r}}function V(e,t){var n={time:L(),url:H(),name:e.name,level:t,message:e.message};if(void 0===e.stack||!e.stack)return n;for(var r,i,a,s=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,c=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,u=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,p=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,l=/\((\S*)(?::(\d+))(?::(\d+))\)/,f=e.stack.split("\n"),h=[],d=0,g=f.length;d<g;++d){if(i=s.exec(f[d])){var R=i[2]&&0===i[2].indexOf("native");i[2]&&0===i[2].indexOf("eval")&&(r=l.exec(i[2]))&&(i[2]=r[1],i[3]=r[2],i[4]=r[3]),a={url:R?null:i[2],func:i[1]||o.UNKNOWN_FUNCTION,args:R?[i[2]]:[],line:i[3]?+i[3]:null,column:i[4]?+i[4]:null}}else if(i=u.exec(f[d]))a={url:i[2],func:i[1]||o.UNKNOWN_FUNCTION,args:[],line:+i[3],column:i[4]?+i[4]:null};else{if(!(i=c.exec(f[d])))continue;i[3]&&i[3].indexOf(" > eval")>-1&&(r=p.exec(i[3]))?(i[3]=r[1],i[4]=r[2],i[5]=null):0!==d||i[5]||void 0===e.columnNumber||(h[0].column=e.columnNumber+1),a={url:i[3],func:i[1]||o.UNKNOWN_FUNCTION,args:i[2]?i[2].split(","):[],line:i[4]?+i[4]:null,column:i[5]?+i[5]:null}}!a.func&&a.line&&(a.func=o.UNKNOWN_FUNCTION),h.push(a)}return h.length?O(O({},n),{stack:h}):null}var K,J,$=function(){function e(){this.stack=[],this.isFlushing=!1,"Promise"in A&&(this.micro=Promise.resolve())}return e.prototype.addFn=function(e){var t=this;"function"==typeof e&&("Promise"in A?(this.stack.push(e),this.isFlushing||(this.isFlushing=!0,this.micro.then((function(){return t.flushStack()})))):e())},e.prototype.clear=function(){this.stack=[]},e.prototype.getStack=function(){return this.stack},e.prototype.flushStack=function(){var e=this.stack.slice(0);this.stack.length=0,this.isFlushing=!1;for(var t=0;t<e.length;t++)e[t]()},e}();!function(e){e.Else="else",e.Error="error",e.Warning="warning",e.Info="info",e.Debug="debug",e.Low="low",e.Normal="normal",e.High="high",e.Critical="critical"}(K||(K={})),function(e){e.fromString=function(t){switch(t){case"debug":return e.Debug;case"info":case"log":case"assert":return e.Info;case"warn":case"warning":return e.Warning;case e.Low:case e.Normal:case e.High:case e.Critical:case"error":return e.Error;default:return e.Else}}}(K||(K={})),function(e){e.Ok="ok",e.DeadlineExceeded="deadline_exceeded",e.Unauthenticated="unauthenticated",e.PermissionDenied="permission_denied",e.NotFound="not_found",e.ResourceExhausted="resource_exhausted",e.InvalidArgument="invalid_argument",e.Unimplemented="unimplemented",e.Unavailable="unavailable",e.InternalError="internal_error",e.UnknownError="unknown_error",e.Cancelled="cancelled",e.AlreadyExists="already_exists",e.FailedPrecondition="failed_precondition",e.Aborted="aborted",e.OutOfRange="out_of_range",e.DataLoss="data_loss"}(J||(J={}));var Y,z,Z=function(){function e(){this.maxBreadcrumbs=10,this.beforePushBreadcrumb=null,this.stack=[]}return e.prototype.push=function(e){var t=this;if("function"!=typeof this.beforePushBreadcrumb)this.immediatePush(e);else{var n=null,r=this.beforePushBreadcrumb;if(j((function(){n=r(t,e)})),!n)return;this.immediatePush(n)}},e.prototype.immediatePush=function(e){e.time||(e.time=L()),this.stack.length>=this.maxBreadcrumbs&&this.shift(),this.stack.push(e),this.stack.sort((function(e,t){return e.time-t.time})),C.log(this.stack)},e.prototype.shift=function(){return void 0!==this.stack.shift()},e.prototype.clear=function(){this.stack=[]},e.prototype.getStack=function(){return this.stack},e.prototype.getCategory=function(e){switch(e){case c.XHR:case c.FETCH:return u.HTTP;case c.CLICK:case c.ROUTE:case c.TAP:case c.TOUCHMOVE:return u.USER;case c.CUSTOMER:case c.CONSOLE:return u.DEBUG;case c.APP_ON_LAUNCH:case c.APP_ON_SHOW:case c.APP_ON_HIDE:case c.PAGE_ON_SHOW:case c.PAGE_ON_HIDE:case c.PAGE_ON_SHARE_APP_MESSAGE:case c.PAGE_ON_SHARE_TIMELINE:case c.PAGE_ON_TAB_ITEM_TAP:return u.LIFECYCLE;case c.UNHANDLEDREJECTION:case c.CODE_ERROR:case c.RESOURCE:case c.VUE:case c.REACT:default:return u.EXCEPTION}},e.prototype.bindOptions=function(e){void 0===e&&(e={});var t=e.maxBreadcrumbs,n=e.beforePushBreadcrumb;F(t,"maxBreadcrumbs","number")&&(this.maxBreadcrumbs=t),F(n,"beforePushBreadcrumb","function")&&(this.beforePushBreadcrumb=n)},e}(),Q=S.breadcrumb||(S.breadcrumb=new Z),ee=function(){function e(){this.beforeAppAjaxSend=function(){},this.traceIdFieldName="Trace-Id",this.throttleDelayTime=0,this.maxDuplicateCount=2,this.appOnLaunch=function(){},this.appOnShow=function(){},this.onPageNotFound=function(){},this.appOnHide=function(){},this.pageOnUnload=function(){},this.pageOnShow=function(){},this.pageOnHide=function(){},this.onShareAppMessage=function(){},this.onShareTimeline=function(){},this.onTabItemTap=function(){},this.triggerWxEvent=function(){},this.enableTraceId=!1}return e.prototype.bindOptions=function(e){void 0===e&&(e={});var t=e.beforeAppAjaxSend,n=e.enableTraceId,r=e.filterXhrUrlRegExp,o=e.traceIdFieldName,i=e.throttleDelayTime,a=e.includeHttpUrlTraceIdRegExp,s=e.appOnLaunch,c=e.appOnShow,u=e.appOnHide,p=e.pageOnUnload,l=e.pageOnShow,f=e.pageOnHide,h=e.onPageNotFound,d=e.onShareAppMessage,g=e.onShareTimeline,O=e.onTabItemTap,R=e.wxNavigateToMiniProgram,E=e.triggerWxEvent,m=e.maxDuplicateCount;F(t,"beforeAppAjaxSend","function")&&(this.beforeAppAjaxSend=t),F(s,"appOnLaunch","function")&&(this.appOnLaunch=s),F(c,"appOnShow","function")&&(this.appOnShow=c),F(u,"appOnHide","function")&&(this.appOnHide=u),F(p,"pageOnUnload","function")&&(this.pageOnUnload=p),F(l,"pageOnShow","function")&&(this.pageOnShow=l),F(f,"pageOnHide","function")&&(this.pageOnHide=f),F(h,"onPageNotFound","function")&&(this.onPageNotFound=h),F(d,"onShareAppMessage","function")&&(this.onShareAppMessage=d),F(g,"onShareTimeline","function")&&(this.onShareTimeline=g),F(O,"onTabItemTap","function")&&(this.onTabItemTap=O),F(R,"wxNavigateToMiniProgram","function")&&(this.wxNavigateToMiniProgram=R),F(E,"triggerWxEvent","function")&&(this.triggerWxEvent=E),F(n,"enableTraceId","boolean")&&(this.enableTraceId=n),F(o,"traceIdFieldName","string")&&(this.traceIdFieldName=o),F(i,"throttleDelayTime","number")&&(this.throttleDelayTime=i),F(m,"maxDuplicateCount","number")&&(this.maxDuplicateCount=m),M(r,"filterXhrUrlRegExp","[object RegExp]")&&(this.filterXhrUrlRegExp=r),M(a,"includeHttpUrlTraceIdRegExp","[object RegExp]")&&(this.includeHttpUrlTraceIdRegExp=a)},e}(),te=S.options||(S.options=new ee),ne={};function re(e,t){var n;switch(e.type){case o.FETCH_ERROR:n=e.type+e.request.method+e.response.status+ie(e.request.url)+t;break;case o.JAVASCRIPT_ERROR:case o.VUE_ERROR:case o.REACT_ERROR:n=e.type+e.name+e.message+t;break;case o.LOG_ERROR:n=e.customTag+e.type+e.name+t;break;case o.PROMISE_ERROR:n=function(e,t){var n=ie(e.url);if(e.name===p.UNHANDLEDREJECTION)return e.type+oe(e.message)+t;return e.type+e.name+oe(e.message)+n}(e,t);break;default:n=e.type+e.message+t}return n=function(e){var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);t=(t<<5)-t+r,t&=t}return t}(n),ne[n]>=te.maxDuplicateCount?null:("number"==typeof ne[n]?ne[n]++:ne[n]=1,n)}function oe(e){var t=function(e){return Object.keys(e).sort().reduce((function(n,r){return y.isObject(e[r])?n[r]=t(e[r]):n[r]=e[r],n}),{})};try{if(/\{.*\}/.test(e)){var n=JSON.parse(e);return n=t(n),JSON.stringify(n)}}catch(t){return e}}function ie(e){return e.replace(/[\?#].*$/,"").replace(/\/\d+([\/]*$)/,"{param}$1")}function ae(e){return void 0===e.actionType&&!e.isTrackData}!function(e){e.Get="GET",e.Post="POST",e.Put="PUT",e.Delete="DELETE"}(Y||(Y={})),function(e){e.PAGE="PAGE",e.EVENT="EVENT",e.VIEW="VIEW",e.DURATION="DURATION",e.DURATION_VIEW="DURATION_VIEW",e.OTHER="OTHER"}(z||(z={}));var se=function(){function e(){this.beforeDataReport=null,this.backTrackerId=null,this.configReportXhr=null,this.configReportUrl=null,this.configReportWxRequest=null,this.useImgUpload=!1,this.apikey="",this.trackKey="",this.errorDsn="",this.trackDsn="",this.queue=new $}return e.prototype.imgRequest=function(e,t){this.queue.addFn((function(){var n=new Image,r=-1===t.indexOf("?")?"?":"&";n.src=""+t+r+"data="+encodeURIComponent(JSON.stringify(e)),n=null}))},e.prototype.getRecord=function(){var e=S.record;return e&&y.isArray(e)&&e.length>2?e:[]},e.prototype.getDeviceInfo=function(){return S.deviceInfo||{}},e.prototype.beforePost=function(e){return n(this,void 0,void 0,(function(){var t,n;return r(this,(function(r){switch(r.label){case 0:if(ae(e)){if(!(t=re(e,this.apikey)))return[2,!1];e.errorId=t}return n=this.getTransportData(e),"function"!=typeof this.beforeDataReport?[3,2]:[4,this.beforeDataReport(n)];case 1:if(!(n=r.sent()))return[2,!1];r.label=2;case 2:return[2,n]}}))}))},e.prototype.xhrPost=function(e,t){return n(this,void 0,void 0,(function(){var n,o=this;return r(this,(function(r){return n=function(){var n=new XMLHttpRequest;n.open(Y.Post,t),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.withCredentials=!0,"function"==typeof o.configReportXhr&&o.configReportXhr(n,e),n.send(JSON.stringify(e))},this.queue.addFn(n),[2]}))}))},e.prototype.wxPost=function(e,o){return n(this,void 0,void 0,(function(){var n,i=this;return r(this,(function(r){return n=function(){var n={method:"POST"};if("function"==typeof i.configReportWxRequest){var r=i.configReportWxRequest(e);n=t(t({},n),r)}n=t(t({},n),{data:JSON.stringify(e),url:o}),wx.request(n)},this.queue.addFn(n),[2]}))}))},e.prototype.getAuthInfo=function(){var e=this.getTrackerId(),t={trackerId:String(e),sdkVersion:"2.1.28",sdkName:"@zyf2e/monitor"};return this.apikey&&(t.apikey=this.apikey),this.trackKey&&(t.trackKey=this.trackKey),t},e.prototype.getApikey=function(){return this.apikey},e.prototype.getTrackKey=function(){return this.trackKey},e.prototype.getTrackerId=function(){if("function"==typeof this.backTrackerId){var e=this.backTrackerId();if("string"==typeof e||"number"==typeof e)return e;C.error("trackerId:"+e+" 期望 string 或 number 类型，但是传入 "+typeof e)}return""},e.prototype.getTransportData=function(e){return{authInfo:this.getAuthInfo(),breadcrumb:Q.getStack(),data:e,record:this.getRecord(),deviceInfo:this.getDeviceInfo()}},e.prototype.isSdkTransportUrl=function(e){var t=!1;return this.errorDsn&&-1!==e.indexOf(this.errorDsn)&&(t=!0),this.trackDsn&&-1!==e.indexOf(this.trackDsn)&&(t=!0),t},e.prototype.bindOptions=function(e){void 0===e&&(e={});var t=e.dsn,n=e.beforeDataReport,r=e.apikey,o=e.configReportXhr,i=e.backTrackerId,a=e.trackDsn,s=e.trackKey,c=e.configReportUrl,u=e.useImgUpload,p=e.configReportWxRequest;F(r,"apikey","string")&&(this.apikey=r),F(s,"trackKey","string")&&(this.trackKey=s),F(t,"dsn","string")&&(this.errorDsn=t),F(a,"trackDsn","string")&&(this.trackDsn=a),F(u,"useImgUpload","boolean")&&(this.useImgUpload=u),F(n,"beforeDataReport","function")&&(this.beforeDataReport=n),F(o,"configReportXhr","function")&&(this.configReportXhr=o),F(i,"backTrackerId","function")&&(this.backTrackerId=i),F(c,"configReportUrl","function")&&(this.configReportUrl=c),F(p,"configReportWxRequest","function")&&(this.configReportWxRequest=p)},e.prototype.send=function(e){return n(this,void 0,void 0,(function(){var t,n;return r(this,(function(r){switch(r.label){case 0:if(t="",ae(e)){if(b(t=this.errorDsn))return C.error("dsn为空，没有传入监控错误上报的dsn地址，请在init中传入"),[2]}else if(b(t=this.trackDsn))return C.error("trackDsn为空，没有传入埋点上报的dsn地址，请在init中传入"),[2];return[4,this.beforePost(e)];case 1:return(n=r.sent())&&("function"!=typeof this.configReportUrl||(t=this.configReportUrl(n,t)))?I?[2,this.useImgUpload?this.imgRequest(n,t):this.xhrPost(n,t)]:N?[2,this.wxPost(n,t)]:[2]:[2]}}))}))},e}(),ce=S.transportData||(S.transportData=new se);function ue(e){var t="",n=e.elapsedTime,r=e.time,i=e.method,a=e.traceId,s=e.type,c=e.status,u=s+"--"+i;return t=(t=0===c?n<=g.crossOriginThreshold?"http请求失败，失败原因：跨域限制或域名不存在":"http请求失败，失败原因：超时":function(e){if(e<400)return J.Ok;if(e>=400&&e<500)switch(e){case 401:return J.Unauthenticated;case 403:return J.PermissionDenied;case 404:return J.NotFound;case 409:return J.AlreadyExists;case 413:return J.FailedPrecondition;case 429:return J.ResourceExhausted;default:return J.InvalidArgument}if(e>=500&&e<600)switch(e){case 501:return J.Unimplemented;case 503:return J.Unavailable;case 504:return J.DeadlineExceeded;default:return J.InternalError}return J.UnknownError}(c))===J.Ok?t:t+" "+ie(e.url),{type:o.FETCH_ERROR,url:H(),time:r,elapsedTime:n,level:K.Low,message:t,name:u,request:{httpType:s,traceId:a,method:i,url:e.url,data:e.reqData||""},response:{status:c,data:e.responseText}}}var pe={img:"图片",script:"js脚本"};var le={handleHttp:function(e,n){var r=0===e.status||e.status===f.BAD_REQUEST||e.status>f.UNAUTHORIZED,o=ue(e);r&&(Q.push({type:n,category:Q.getCategory(c.CODE_ERROR),data:t({},o),level:K.Error,time:e.time}),ce.send(o))},handleError:function(e){if(e.target.localName){var n=function(e){return{type:o.RESOURCE_ERROR,url:H(),message:"资源地址: "+(B(e.src,120)||B(e.href,120)),level:K.Low,time:L(),name:(pe[e.localName]||e.localName)+"加载失败"}}(e.target);return Q.push({type:c.RESOURCE,category:Q.getCategory(c.RESOURCE),data:n,level:K.Error}),ce.send(n)}var r,i=e.message,a=e.filename,s=e.lineno,u=e.colno,p=e.error;p&&v(p)&&(r=V(p,K.Normal)),r||(r=le.handleNotErrorInstance(i,a,s,u)),r.type=o.JAVASCRIPT_ERROR,Q.push({type:c.CODE_ERROR,category:Q.getCategory(c.CODE_ERROR),data:t({},r),level:K.Error}),ce.send(r)},handleNotErrorInstance:function(e,t,n,r){var i=o.UNKNOWN,a=t||H(),s=e,c=e.match(d);c[1]&&(i=c[1],s=c[2]);var u={url:a,func:o.UNKNOWN_FUNCTION,args:o.UNKNOWN,line:n,col:r};return{url:a,name:i,message:s,level:K.Normal,time:L(),stack:[u]}},handleHistory:function(e){var t=e.from,n=e.to,r=G(t).relative,o=G(n).relative;Q.push({type:c.ROUTE,category:Q.getCategory(c.ROUTE),data:{from:r||"/",to:o||"/"},level:K.Info}),ce.send({from:r||"/",to:o||"/"})},handleHashchange:function(e){var t=e.oldURL,n=e.newURL,r=G(t).relative,o=G(n).relative;Q.push({type:c.ROUTE,category:Q.getCategory(c.ROUTE),data:{from:r,to:o},level:K.Info}),ce.send({from:r,to:o})},handleUnhandleRejection:function(e){var n={type:o.PROMISE_ERROR,message:W(e.reason),url:H(),name:e.type,time:L(),level:K.Low};v(e.reason)&&(n=t(t({},n),V(e.reason,K.Low))),Q.push({type:c.UNHANDLEDREJECTION,category:Q.getCategory(c.UNHANDLEDREJECTION),data:t({},n),level:K.Error}),ce.send(n)}},fe=function(){function e(){this.maxBreadcrumbs=10,this.beforePushBreadcrumb=null,this.stack=[]}return e.prototype.push=function(e){var t=this;if("function"!=typeof this.beforePushBreadcrumb)this.immediatePush(e);else{var n=null,r=this.beforePushBreadcrumb;if(j((function(){n=r(t,e)})),!n)return;this.immediatePush(n)}},e.prototype.immediatePush=function(e){e.time||(e.time=L()),this.stack.length>=this.maxBreadcrumbs&&this.shift(),this.stack.push(e),this.stack.sort((function(e,t){return e.time-t.time})),C.log(this.stack)},e.prototype.shift=function(){return void 0!==this.stack.shift()},e.prototype.clear=function(){this.stack=[]},e.prototype.getStack=function(){return this.stack},e.prototype.getCategory=function(e){switch(e){case c.XHR:case c.FETCH:return u.HTTP;case c.CLICK:case c.ROUTE:case c.TAP:case c.TOUCHMOVE:return u.USER;case c.CUSTOMER:case c.CONSOLE:return u.DEBUG;case c.APP_ON_LAUNCH:case c.APP_ON_SHOW:case c.APP_ON_HIDE:case c.PAGE_ON_SHOW:case c.PAGE_ON_HIDE:case c.PAGE_ON_SHARE_APP_MESSAGE:case c.PAGE_ON_SHARE_TIMELINE:case c.PAGE_ON_TAB_ITEM_TAP:return u.LIFECYCLE;case c.UNHANDLEDREJECTION:case c.CODE_ERROR:case c.RESOURCE:case c.VUE:case c.REACT:default:return u.EXCEPTION}},e.prototype.bindOptions=function(e){void 0===e&&(e={});var t=e.maxBreadcrumbs,n=e.beforePushBreadcrumb;F(t,"maxBreadcrumbs","number")&&(this.maxBreadcrumbs=t),F(n,"beforePushBreadcrumb","function")&&(this.beforePushBreadcrumb=n)},e}(),he=S.breadcrumb||(S.breadcrumb=new fe),de=function(){return(de=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function ge(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function Oe(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var Re=function(){function e(){this.beforeAppAjaxSend=function(){},this.traceIdFieldName="Trace-Id",this.throttleDelayTime=0,this.maxDuplicateCount=2,this.appOnLaunch=function(){},this.appOnShow=function(){},this.onPageNotFound=function(){},this.appOnHide=function(){},this.pageOnUnload=function(){},this.pageOnShow=function(){},this.pageOnHide=function(){},this.onShareAppMessage=function(){},this.onShareTimeline=function(){},this.onTabItemTap=function(){},this.triggerWxEvent=function(){},this.enableTraceId=!1}return e.prototype.bindOptions=function(e){void 0===e&&(e={});var t=e.beforeAppAjaxSend,n=e.enableTraceId,r=e.filterXhrUrlRegExp,o=e.traceIdFieldName,i=e.throttleDelayTime,a=e.includeHttpUrlTraceIdRegExp,s=e.appOnLaunch,c=e.appOnShow,u=e.appOnHide,p=e.pageOnUnload,l=e.pageOnShow,f=e.pageOnHide,h=e.onPageNotFound,d=e.onShareAppMessage,g=e.onShareTimeline,O=e.onTabItemTap,R=e.wxNavigateToMiniProgram,E=e.triggerWxEvent,m=e.maxDuplicateCount;F(t,"beforeAppAjaxSend","function")&&(this.beforeAppAjaxSend=t),F(s,"appOnLaunch","function")&&(this.appOnLaunch=s),F(c,"appOnShow","function")&&(this.appOnShow=c),F(u,"appOnHide","function")&&(this.appOnHide=u),F(p,"pageOnUnload","function")&&(this.pageOnUnload=p),F(l,"pageOnShow","function")&&(this.pageOnShow=l),F(f,"pageOnHide","function")&&(this.pageOnHide=f),F(h,"onPageNotFound","function")&&(this.onPageNotFound=h),F(d,"onShareAppMessage","function")&&(this.onShareAppMessage=d),F(g,"onShareTimeline","function")&&(this.onShareTimeline=g),F(O,"onTabItemTap","function")&&(this.onTabItemTap=O),F(R,"wxNavigateToMiniProgram","function")&&(this.wxNavigateToMiniProgram=R),F(E,"triggerWxEvent","function")&&(this.triggerWxEvent=E),F(n,"enableTraceId","boolean")&&(this.enableTraceId=n),F(o,"traceIdFieldName","string")&&(this.traceIdFieldName=o),F(i,"throttleDelayTime","number")&&(this.throttleDelayTime=i),F(m,"maxDuplicateCount","number")&&(this.maxDuplicateCount=m),M(r,"filterXhrUrlRegExp","[object RegExp]")&&(this.filterXhrUrlRegExp=r),M(a,"includeHttpUrlTraceIdRegExp","[object RegExp]")&&(this.includeHttpUrlTraceIdRegExp=a)},e}(),Ee=S.options||(S.options=new Re);function me(e,t){var n,r=Ee.includeHttpUrlTraceIdRegExp;if(Ee.enableTraceId&&r&&r.test(e)){var o=(n=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})));t(Ee.traceIdFieldName,o)}}function ye(e){void 0===e&&(e={}),function(e){void 0===e&&(e={}),k(p.XHR,!!e.silentXhr),k(p.FETCH,!!e.silentFetch),k(p.CONSOLE,!!e.silentConsole),k(p.DOM,!!e.silentDom),k(p.HISTORY,!!e.silentHistory),k(p.ERROR,!!e.silentError),k(p.HASHCHANGE,!!e.silentHashchange),k(p.UNHANDLEDREJECTION,!!e.silentUnhandledrejection),k(p.VUE,!!e.silentVue),k(i.AppOnError,!!e.silentWxOnError),k(i.AppOnUnhandledRejection,!!e.silentUnhandledrejection),k(i.AppOnPageNotFound,!!e.silentWxOnPageNotFound),k(a.PageOnShareAppMessage,!!e.silentWxOnShareAppMessage),k(p.MINI_ROUTE,!!e.silentMiniRoute)}(e),he.bindOptions(e),C.bindOptions(e.debug),Ae.bindOptions(e),Ee.bindOptions(e)}var ve={};function be(e,t){var n;switch(e.type){case o.FETCH_ERROR:n=e.type+e.request.method+e.response.status+Ne(e.request.url)+t;break;case o.JAVASCRIPT_ERROR:case o.VUE_ERROR:case o.REACT_ERROR:n=e.type+e.name+e.message+t;break;case o.LOG_ERROR:n=e.customTag+e.type+e.name+t;break;case o.PROMISE_ERROR:n=function(e,t){var n=Ne(e.url);if(e.name===p.UNHANDLEDREJECTION)return e.type+Te(e.message)+t;return e.type+e.name+Te(e.message)+n}(e,t);break;default:n=e.type+e.message+t}return n=function(e){var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);t=(t<<5)-t+r,t&=t}return t}(n),ve[n]>=Ee.maxDuplicateCount?null:("number"==typeof ve[n]?ve[n]++:ve[n]=1,n)}function Te(e){var t=function(e){return Object.keys(e).sort().reduce((function(n,r){return y.isObject(e[r])?n[r]=t(e[r]):n[r]=e[r],n}),{})};try{if(/\{.*\}/.test(e)){var n=JSON.parse(e);return n=t(n),JSON.stringify(n)}}catch(t){return e}}function Ne(e){return e.replace(/[\?#].*$/,"").replace(/\/\d+([\/]*$)/,"{param}$1")}var Ie=function(){function e(){this.beforeDataReport=null,this.backTrackerId=null,this.configReportXhr=null,this.configReportUrl=null,this.configReportWxRequest=null,this.useImgUpload=!1,this.apikey="",this.trackKey="",this.errorDsn="",this.trackDsn="",this.queue=new $}return e.prototype.imgRequest=function(e,t){this.queue.addFn((function(){var n=new Image,r=-1===t.indexOf("?")?"?":"&";n.src=""+t+r+"data="+encodeURIComponent(JSON.stringify(e)),n=null}))},e.prototype.getRecord=function(){var e=S.record;return e&&y.isArray(e)&&e.length>2?e:[]},e.prototype.getDeviceInfo=function(){return S.deviceInfo||{}},e.prototype.beforePost=function(e){return ge(this,void 0,void 0,(function(){var t,n;return Oe(this,(function(r){switch(r.label){case 0:if(ae(e)){if(!(t=be(e,this.apikey)))return[2,!1];e.errorId=t}return n=this.getTransportData(e),"function"!=typeof this.beforeDataReport?[3,2]:[4,this.beforeDataReport(n)];case 1:if(!(n=r.sent()))return[2,!1];r.label=2;case 2:return[2,n]}}))}))},e.prototype.xhrPost=function(e,t){return ge(this,void 0,void 0,(function(){var n,r=this;return Oe(this,(function(o){return n=function(){var n=new XMLHttpRequest;n.open(Y.Post,t),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.withCredentials=!0,"function"==typeof r.configReportXhr&&r.configReportXhr(n,e),n.send(JSON.stringify(e))},this.queue.addFn(n),[2]}))}))},e.prototype.wxPost=function(e,t){return ge(this,void 0,void 0,(function(){var n,r=this;return Oe(this,(function(o){return n=function(){var n={method:"POST"};if("function"==typeof r.configReportWxRequest){var o=r.configReportWxRequest(e);n=de(de({},n),o)}n=de(de({},n),{data:JSON.stringify(e),url:t}),wx.request(n)},this.queue.addFn(n),[2]}))}))},e.prototype.getAuthInfo=function(){var e=this.getTrackerId(),t={trackerId:String(e),sdkVersion:"2.1.28",sdkName:"@zyf2e/monitor"};return this.apikey&&(t.apikey=this.apikey),this.trackKey&&(t.trackKey=this.trackKey),t},e.prototype.getApikey=function(){return this.apikey},e.prototype.getTrackKey=function(){return this.trackKey},e.prototype.getTrackerId=function(){if("function"==typeof this.backTrackerId){var e=this.backTrackerId();if("string"==typeof e||"number"==typeof e)return e;C.error("trackerId:"+e+" 期望 string 或 number 类型，但是传入 "+typeof e)}return""},e.prototype.getTransportData=function(e){return{authInfo:this.getAuthInfo(),breadcrumb:he.getStack(),data:e,record:this.getRecord(),deviceInfo:this.getDeviceInfo()}},e.prototype.isSdkTransportUrl=function(e){var t=!1;return this.errorDsn&&-1!==e.indexOf(this.errorDsn)&&(t=!0),this.trackDsn&&-1!==e.indexOf(this.trackDsn)&&(t=!0),t},e.prototype.bindOptions=function(e){void 0===e&&(e={});var t=e.dsn,n=e.beforeDataReport,r=e.apikey,o=e.configReportXhr,i=e.backTrackerId,a=e.trackDsn,s=e.trackKey,c=e.configReportUrl,u=e.useImgUpload,p=e.configReportWxRequest;F(r,"apikey","string")&&(this.apikey=r),F(s,"trackKey","string")&&(this.trackKey=s),F(t,"dsn","string")&&(this.errorDsn=t),F(a,"trackDsn","string")&&(this.trackDsn=a),F(u,"useImgUpload","boolean")&&(this.useImgUpload=u),F(n,"beforeDataReport","function")&&(this.beforeDataReport=n),F(o,"configReportXhr","function")&&(this.configReportXhr=o),F(i,"backTrackerId","function")&&(this.backTrackerId=i),F(c,"configReportUrl","function")&&(this.configReportUrl=c),F(p,"configReportWxRequest","function")&&(this.configReportWxRequest=p)},e.prototype.send=function(e){return ge(this,void 0,void 0,(function(){var t,n;return Oe(this,(function(r){switch(r.label){case 0:if(t="",ae(e)){if(b(t=this.errorDsn))return C.error("dsn为空，没有传入监控错误上报的dsn地址，请在init中传入"),[2]}else if(b(t=this.trackDsn))return C.error("trackDsn为空，没有传入埋点上报的dsn地址，请在init中传入"),[2];return[4,this.beforePost(e)];case 1:return(n=r.sent())&&("function"!=typeof this.configReportUrl||(t=this.configReportUrl(n,t)))?I?[2,this.useImgUpload?this.imgRequest(n,t):this.xhrPost(n,t)]:N?[2,this.wxPost(n,t)]:[2]:[2]}}))}))},e}(),Ae=S.transportData||(S.transportData=new Ie);var Se,xe={};function ke(e,t){e&&xe[e]&&xe[e].forEach((function(n){!function(e,t){try{e()}catch(e){console.log("err",e),t&&t(e)}}((function(){n(t)}),(function(t){var r;C.error("重写事件triggerHandlers的回调函数发生错误\nType:"+e+"\nName: "+(((r=n)&&"function"==typeof r&&r.name||"<anonymous>")+"\nError: ")+t)}))}))}function Ue(e){return Ee.filterXhrUrlRegExp&&Ee.filterXhrUrlRegExp.test(e)}function _e(e){switch(e){case p.XHR:!function(){if(!("XMLHttpRequest"in A))return;var e=XMLHttpRequest.prototype;w(e,"open",(function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.mito_xhr={method:y.isString(t[0])?t[0].toUpperCase():t[0],url:t[1],sTime:L(),type:l.XHR},e.apply(this,t)}})),w(e,"send",(function(e){return function(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=this.mito_xhr,i=o.method,a=o.url;me(a,(function(e,n){t.mito_xhr.traceId=n,t.setRequestHeader(e,n)})),Ee.beforeAppAjaxSend&&Ee.beforeAppAjaxSend({method:i,url:a},this),D(this,"loadend",(function(){if(!(i===Y.Post&&Ae.isSdkTransportUrl(a)||Ue(a))){var e=this.responseType,t=this.response,r=this.status;this.mito_xhr.reqData=n[0];var o=L();this.mito_xhr.time=this.mito_xhr.sTime,this.mito_xhr.status=r,-1!==["","json","text"].indexOf(e)&&(this.mito_xhr.responseText="object"==typeof t?JSON.stringify(t):t),this.mito_xhr.elapsedTime=o-this.mito_xhr.sTime,ke(p.XHR,this.mito_xhr)}})),e.apply(this,n)}}))}();break;case p.FETCH:!function(){if(!("fetch"in A))return;w(A,p.FETCH,(function(e){return function(n,r){void 0===r&&(r={});var o=L(),i=r&&r.method||"GET",a={type:l.FETCH,method:i,reqData:r&&r.body,url:n},s=new Headers(r.headers||{});return Object.assign(s,{setRequestHeader:s.set}),me(n,(function(e,t){a.traceId=t,s.set(e,t)})),Ee.beforeAppAjaxSend&&Ee.beforeAppAjaxSend({method:i,url:n},s),r=t(t({},r),{headers:s}),e.apply(A,[n,r]).then((function(e){var r=e.clone(),s=L();return a=t(t({},a),{elapsedTime:s-o,status:r.status,time:o}),r.text().then((function(e){i===Y.Post&&Ae.isSdkTransportUrl(n)||Ue(n)||(a.responseText=r.status>f.UNAUTHORIZED&&e,ke(p.FETCH,a))})),e}),(function(e){var r=L();if(!(i===Y.Post&&Ae.isSdkTransportUrl(n)||Ue(n)))throw a=t(t({},a),{elapsedTime:r-o,status:0,time:o}),ke(p.FETCH,a),e}))}}))}();break;case p.ERROR:D(A,"error",(function(e){ke(p.ERROR,e)}),!0);break;case p.CONSOLE:!function(){if(!("console"in A))return;["log","debug","info","warn","error","assert"].forEach((function(e){e in A.console&&w(A.console,e,(function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];t&&ke(p.CONSOLE,{args:n,level:e})}}))}))}();break;case p.HISTORY:!function(){if(e=A.chrome,t=e&&e.app&&e.app.runtime,n="history"in A&&!!A.history.pushState&&!!A.history.replaceState,t||!n)return;var e,t,n;var r=A.onpopstate;function o(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.length>2?t[2]:void 0;if(r){var o=Se,i=String(r);Se=i,ke(p.HISTORY,{from:o,to:i})}return e.apply(this,t)}}A.onpopstate=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=H(),o=Se;Se=n,ke(p.HISTORY,{from:o,to:n}),r&&r.apply(this,e)},w(A.history,"pushState",o),w(A.history,"replaceState",o)}();break;case p.UNHANDLEDREJECTION:D(A,p.UNHANDLEDREJECTION,(function(e){ke(p.UNHANDLEDREJECTION,e)}));break;case p.DOM:!function(){if(!("document"in A))return;var e=(t=ke,n=Ee.throttleDelayTime,r=!0,function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];r&&(t.apply(this,e),r=!1,setTimeout((function(){r=!0}),n))});var t,n,r;D(A.document,"click",(function(){e(p.DOM,{category:"click",data:this})}),!0)}();break;case p.HASHCHANGE:n="onpopstate",A.hasOwnProperty(n)||D(A,p.HASHCHANGE,(function(e){ke(p.HASHCHANGE,e)}))}var n}function Pe(e){(function(e){return!(!e||U(e.type))&&(k(e.type,!0),xe[e.type]=xe[e.type]||[],xe[e.type].push(e.callback),!0)})(e)&&_e(e.type)}function Ce(){Pe({callback:function(e){le.handleHttp(e,c.XHR)},type:p.XHR}),Pe({callback:function(e){le.handleHttp(e,c.FETCH)},type:p.FETCH}),Pe({callback:function(e){le.handleError(e)},type:p.ERROR}),Pe({callback:function(e){!function(e){g.isLogAddBreadcrumb&&Q.push({type:c.CONSOLE,category:Q.getCategory(c.CONSOLE),data:e,level:K.fromString(e.level)})}(e)},type:p.CONSOLE}),Pe({callback:function(e){le.handleHistory(e)},type:p.HISTORY}),Pe({callback:function(e){le.handleUnhandleRejection(e)},type:p.UNHANDLEDREJECTION}),Pe({callback:function(e){var t=function(e){var t=e.tagName.toLowerCase();if("body"===t)return null;var n=e.classList.value;return n=""!==n?' class="'+n+'"':"","<"+t+(e.id?' id="'+e.id+'"':"")+(""!==n?n:"")+">"+e.innerText+"</"+t+">"}(e.data.activeElement);t&&Q.push({type:c.CLICK,category:Q.getCategory(c.CLICK),data:t,level:K.Info}),ce.send(e)},type:p.DOM}),Pe({callback:function(e){le.handleHashchange(e)},type:p.HASHCHANGE})}Se=H();var He=function(){return(He=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function De(e,t,n,r,i,a){var s=null==a?void 0:a.version,u={type:o.VUE_ERROR,message:e.message+"("+n+")",level:r,url:H(),name:e.name,stack:e.stack||[],time:L()};if(y.isString(s))switch(console.log("getBigVersion",q(s)),q(s)){case 2:u=He(He({},u),function(e){var t="";if(e.$root===e)t="root";else{var n=e._isVue?e.$options&&e.$options.name||e.$options&&e.$options._componentTag:e.name;t=(n?"component <"+n+">":"anonymous component")+(e._isVue&&e.$options&&e.$options.__file?" at "+(e.$options&&e.$options.__file):"")}return{componentName:t,propsData:e.$options&&e.$options.propsData}}(t));break;case 3:u=He(He({},u),function(e){var t="";if(e.$root===e)t="root";else{console.log(e.$options);var n=e.$options&&e.$options.name;t=n?"component <"+n+">":"anonymous component"}return{componentName:t,propsData:e.$props}}(t));break;default:return}he.push({type:c.VUE,category:he.getCategory(c.VUE),data:u,level:i}),Ae.send(u)}var we="undefined"!=typeof console,Le={install:function(e){!U(p.VUE)&&e&&e.config&&(k(p.VUE,!0),e.config.errorHandler=function(t,n,r){De.apply(null,[t,n,r,K.Normal,K.Error,e]),we&&!e.config.silent&&j((function(){console.error("Error in "+r+': "'+t.toString()+'"',n),console.error(t)}))})}};return e.MitoVue=Le,e.SDK_NAME="@zyf2e/monitor",e.SDK_VERSION="2.1.28",e.errorBoundaryReport=function(e){if(v(e)){var t=V(e,K.Normal);t.type=o.REACT_ERROR,he.push({type:c.REACT,category:he.getCategory(c.REACT),data:t.name+": "+t.message,level:K.fromString(t.level)}),Ae.send(t)}else console.warn("传入的react error不是一个object Error")},e.init=function(e){void 0===e&&(e={}),function(e){void 0===e&&(e={}),"XMLHttpRequest"in A&&!e.disabled&&(ye(e),Ce())}(e)},e.log=function(e){var t=e.message,n=void 0===t?"emptyMsg":t,r=e.tag,i=void 0===r?"":r,a=e.level,s=void 0===a?K.Critical:a,u=e.ex,p=void 0===u?"":u,l={};v(p)&&(l=V(p,s));var f=de({type:o.LOG_ERROR,level:s,message:W(n),name:"MITO.log",customTag:W(i),time:L(),url:N?X():H()},l);he.push({type:c.CUSTOMER,category:he.getCategory(c.CUSTOMER),data:n,level:K.fromString(s.toString())}),Ae.send(f)},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
